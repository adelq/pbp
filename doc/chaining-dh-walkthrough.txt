|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| Eout1 | Ein1 | PEERpub | OUT        | IN           | IN_prev   | op                                  | Eout2 | Ein2 | PEERpub | OUT       | IN           | IN_prev   |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| e11   |      |         |            |              |           | -> C*(CS2, g^e11+0[32]+msg)     ->  |       |      | g^e11   |           |              |           |
| rnd   |      |         |            |              |           | -> C*(CS2, Eout1+Ein1+msg)      ->  |       |      | dh1     |           |              |           |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| e11   |      | g^e21   | g^e22*e11  |              |           | <- C*(CS1, g^e21+g^e22+msg)      <- | e21   | e22  |         |           | g^e11*e22    |           |
|       |      | dh1     | dh2*Eout1  |              |           | <- C*(CS1, Eout2+Ein2+msg)       <- | rnd   | rnd  |         |           | PEERpub*Ein2 |           |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| e12   | e13  |         | g^e22*e11  | g^e21*e13    |           | -> C(g^e22*e11, g^e12+g^e13+msg) -> | e21   | e22  | g^e12   | g^e13*e21 | g^e11*e22    |           |
| rnd   | rnd  |         |            | PEERpub*Ein1 |           | -> C(OUT1, Eout1+Ein1+msg)       -> |       |      | dh1     | dh2*Eout2 |              |           |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| e12   | e13  | g^e23   | g^e24*e12  | g^e21*e13    |           | <- C(g^e12*e21, g^e23+g^e24+msg) <- | e23   | e24  |         | g^e13*e21 | g^e12*e24    | g^e11*e22 |
|       |      | dh1     | dh2*Eout1  |              |           | <- C(OUT2, Eout2+Ein2+msg)       <- | rnd   | rnd  |         |           | PEERpub*Ein2 | IN        |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| e14   | e15  |         | g^e24*e12  | g^e23*e15    | g^e21*e13 | -> C(g^e24*e13, g^e14+g^e15+msg) -> | e23   | e24  | g^e14   | g^e15*e23 | g^e12*e24    | g^e11*e22 |
| rnd   | rnd  |         |            | PEERpub*Ein1 | IN        | -> C(OUT1,      Eout1+Ein1+msg)  -> |       |      | dh1     | dh2*Eout2 |              |           |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| e14   | e15  | g^e25   | g^e26*e14  | g^e23*e15    | g^e21*e13 | <- C(g^e15*e23, g^e25+g^e26+msg) <- | e25   | e26  |         | g^e15*e23 | g^e14*e26    | g^e12*e24 |
|       |      | dh1     | dh2*Eout1  |              |           | <- C(OUT2, Eout2+Ein2+msg)       <- | rnd   | rnd  |         |           | PEERpub*Ein2 | IN        |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
| e14   | e15  | g^e25   | g^e26*e14  | g^e23*e15    | g^e21*e13 | <- C(g^e15*e23, g^e25+g^e26+msg) <- | e25   | e26  |         | g^e15*e23 | g^e14*e26    | g^e12*e24 |
|       |      | dh1=    | dh2*Eout1= |              |           | <- C(OUT2, Eout2+Ein2+msg)       <- |       |      |         |           |              |           |
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|
|-------+------+---------+------------+--------------+-----------+-------------------------------------+-------+------+---------+-----------+--------------+-----------|

